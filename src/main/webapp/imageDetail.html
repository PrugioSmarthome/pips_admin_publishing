<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <!-- 공통: css영역(file: default.stylesheet.new) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://www.prugio.com/asset/images/common/favicon.ico"
    />
    <link rel="stylesheet" type="text/css" href="./styles/bootstrap.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="./styles/bootstrap-datepicker.css"
    />
    <link rel="stylesheet" type="text/css" href="./styles/all.min.css" />
    <link rel="stylesheet" type="text/css" href="./styles/jquery-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="./styles/ui.dynatree.css" />
    <link rel="stylesheet" type="text/css" href="./styles/custom.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="./styles/fontawesome-all.css"
    />
    <link rel="stylesheet" type="text/css" href="./styles/custom/main.css" />
    <!-- 공통: css영역(file: default.stylesheet.new) -->

    <!-- 공통: js영역(file: default.stylesheet.new) -->
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery-1.11.2.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery-3.4.1.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery-ui-1.11.3.custom.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery-ui.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery-migrate-1.2.1.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery.validate.1.13.1.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/additional-methods.1.13.1.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery.form.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery.simplemodal.1.4.4.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/bootstrap.bundle.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/jquery.dynatree.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/bootstrap-datepicker.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/jquery/bootstrap-datepicker.ko.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/common_ui.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/nisf.common.js?v=1"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/nisf/nisf.menupage.js?v=2"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/nisf/nisf.paging.js?v=3"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/nisf/nisf.passwd.js?v=1"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/nisf/nisf.selectbox.js?v=1"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/sockjs/sockjs.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/stomp/stomp.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/filesaver/FileSaver.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/notification.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="./scripts/login.js"
    ></script>
    <script type="text/javascript">
      /* var current_user = '<c:out value="${session_user.userId}"/>'
    var url = '<c:out value="${stompInfo.webUrl}"/>'
    var userId = '<c:out value="${stompInfo.webUserId}"/>'
    var messageInfo = decodeMessage('<c:out value="${stompInfo.webMessage}"/>'); */

      var webSocketClient;

      function subscribeMessage() {
        var messages = messageInfo.split(":");

        if (webSocketClient != null || webSocketClient != undefined) {
          disconnectWebSocketClient(webSocketClient);
        }

        webSocketClient = initWebSocketClient(url);
        initWebSocket(webSocketClient, userId, messages[1]);
      }

      if (
        current_user != null &&
        current_user != "" &&
        current_user != undefined &&
        url != undefined &&
        userId != undefined &&
        messageInfo != undefined
      ) {
        subscribeMessage();
        setInterval(subscribeMessage, 60 * 1000);
      }

      function checkServerStatus() {
        var webServiceStatus = checkServerConnection();

        if (!webServiceStatus && current_user != null && current_user != "") {
          console.log("Server Restart or Down");
          alert("재로그인 해주십시오.");
          location.href = "/cm/login";
        }
      }

      checkServerStatus();
      setInterval(checkServerStatus, 10 * 1000);

      function checkSocketConnection() {
        var isWebAlive = checkServerConnection();

        if (isWebAlive) {
          console.log("isWebAlive is true");

          if (
            current_user != null &&
            current_user != "" &&
            current_user != undefined &&
            url != undefined &&
            userId != undefined &&
            messageInfo != undefined
          ) {
            subscribeMessage();
            setInterval(subscribeMessage, 60 * 1000);
          }
        } else {
          console.log("isWebAlive is false");
          console.log("retryInitWebSocket failure");
        }
      }

      function checkServerConnection() {
        var xhr = new XMLHttpRequest();
        var origin = window.location.origin;
        var fileUrl = origin + "/images/h1_logo.png";
        var r = Math.round(Math.random() * 10000);
        xhr.open("HEAD", fileUrl + "?subins=" + r, false);

        try {
          xhr.send();

          if (xhr.status >= 200 && xhr.status < 304) {
            return true;
          } else {
            return false;
          }
        } catch (e) {
          return false;
        }
      }

      function decodeMessage(str) {
        return decodeURIComponent(
          atob(str)
            .split("")
            .map(function (c) {
              return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
            })
            .join("")
        );
      }

      function fileDownload(fileName, fileUrl) {
        var oReq = new XMLHttpRequest();
        // The Endpoint of your server
        var URLToPDF = fileUrl;

        // Configure XMLHttpRequest
        oReq.open("GET", URLToPDF, true);

        // Important to use the blob response type
        oReq.responseType = "blob";

        // When the file request finishes
        // Is up to you, the configuration for error events etc.
        oReq.onload = function () {
          // Once the file is downloaded, open a new window with the PDF
          // Remember to allow the POP-UPS in your browser
          var file = new Blob([oReq.response], {
            type: "application/pdf",
          });

          // Generate file download directly in the browser !
          saveAs(file, fileName);
        };

        oReq.send();
      }
    </script>
    <!-- 공통: js영역(file: default.stylesheet.new) -->
  </head>

  <body>
    <script type="text/javascript"></script>

    <!-- 모바일 Header -->
    <div class="mobile-top-bar">
      <div class="mobile-gnb-logo"></div>
      <div class="mobile-btn-menu"></div>
    </div>
    <!-- // 모바일 Header -->

    <div id="wrap">
      <!-- 공통: GNB/Left-body 영역 (file: default.left.body) -->
      <div id="gnb" class="left-navigation">
        <div class="logo-wrap">
          <div class="gnb-logo"></div>
          <div class="btn-menu"></div>
        </div>
        <ul class="gnb-menu">
          <li id="top_menu" class="gnb-ic-dashboard">
            <a>대시보드</a>
          </li>
          <li id="top_menu" class="--active gnb-ic-complex">
            <a>단지관리</a>
          </li>
          <li id="sub_menu_link" class="mt-3"><a>단지정보 관리</a></li>
          <li id="sub_menu"><a>세대장치 관리</a></li>
          <li id="sub_menu"><a>방문차량 관리</a></li>
          <li id="sub_menu" class="mb-3"><a>단지 관리비 관리</a></li>
          <li id="top_menu">
            <a>앱 서랍 관리</a>
          </li>
          <li id="sub_menu"><a>hhhhhhhhh</a></li>
          <li id="sub_menu"><a>jjjjjjjjjjjj</a></li>
          <li id="sub_menu"><a>jjjjjjjj</a></li>
          <li id="sub_menu"><a>jjjjjjjjjj</a></li>
          <li id="top_menu">
            <a>zzzzzzzzzzzzz</a>
          </li>
          <li id="sub_menu"><a>xxxxxxxxxx</a></li>
          <li id="sub_menu"><a>xxxxxx</a></li>
          <li id="sub_menu"><a>yyyyyyyyy</a></li>
          <li id="sub_menu"><a>jjjjjjjjjj</a></li>
          <li id="top_menu">
            <a>jjjjjj</a>
          </li>
          <li id="sub_menu"><a>hhhhhhhh</a></li>
          <li id="sub_menu"><a>ttttttttt</a></li>
          <li id="sub_menu"><a>3333333</a></li>
          <li id="sub_menu"><a>2222</a></li>
        </ul>
        <div class="gnb-user" data-toggle="modal" data-target="#modal2">
          <span>홍길동</span>님
        </div>
      </div>
      <!-- 공통: GNB/Left-body 영역 (file: default.left.body) -->

      <!-- Right-body 영역 실제 페이지 -->
      <div id="container">
        <div class="custom-layout">
          <div class="title-wrap">
            <h1>단지 배치도</h1>
            <span class="bread-crumbs"
              >단지관리 > 단지정보 관리 > 단지 배치도</span
            >
          </div>
          <section class="board-container">
            <div class="board-title">
              <span>단지 배치도</span>
            </div>
            <div class="image-wrap">
              <div class="image-add">
                <div class="add-icon"></div>
                <div>단지배치도</div>
                <div>이미지를 등록해주세요</div>
              </div>
            </div>
            <div class="button-wrap">
              <button class="custom-button fit-button color-outline-black mr-3">
                목록
              </button>
              <button class="custom-button fit-button color-black">
                등록
              </button>
            </div>
          </section>
          <!-- 목록 -->
        </div>
      </div>

      <!-- 단지선택 팝업 -->
      <div class="modal fade" id="modal1" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content custom-modal select-complex">
            <!-- 모달헤더 -->
            <div class="modal-header">
              <h5 class="modal-title">단지선택</h5>
              <div id="closebtn" data-dismiss="modal" class="modal-close"></div>
            </div>
            <!-- //모달헤더 -->
            <section class="modal-body">
              <div class="search-wrap">
                <input
                  type="text"
                  class="custom-input w-100 mr-2"
                  name="firstName"
                  placeholder="검색어"
                />
                <button class="custom-button fit-button color-black">
                  검색
                </button>
              </div>
              <table class="board-table">
                <thead>
                  <tr class="board-table__header">
                    <th>항목</th>
                    <th class="select-th">선택</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="table-value">APT Name 019</td>
                    <td class="table-value">
                      <span class="select-link">선택</span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="pagination-wrap">
                <div class="pagination-wrap__left"></div>
                <div class="pagination">
                  <div class="pagination__btn pre-pre"></div>
                  <div class="pagination__btn pre"></div>
                  <ul>
                    <li class="num">1</li>
                    <li class="num">2</li>
                    <li class="num">3</li>
                    <li class="num --active">4</li>
                    <li class="num">5</li>
                  </ul>
                  <div class="pagination__btn next"></div>
                  <div class="pagination__btn next-next"></div>
                </div>
                <div class="pagination-wrap__right"></div>
              </div>
            </section>
          </div>
        </div>
      </div>
      <!-- 내정보 팝업 -->
      <div class="modal fade" id="modal2" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content custom-modal">
            <!-- 모달헤더 -->
            <div class="modal-header">
              <h5 class="modal-title">마이페이지</h5>
              <div id="closebtn" data-dismiss="modal" class="modal-close"></div>
            </div>
            <!-- //모달헤더 -->
            <section class="modal-body">
              <div class="info-line">
                <div class="info-line__index">아이디</div>
                <div class="info-line__value">abc@gmail.com</div>
              </div>
              <div class="info-line">
                <div class="info-line__index">아이디</div>
                <div class="info-line__value">abc@gmail.com</div>
              </div>
              <div class="info-line">
                <div class="info-line__index">아이디</div>
                <div class="info-line__value">abc@gmail.com</div>
              </div>
              <div class="info-line">
                <div class="info-line__index">아이디</div>
                <div class="info-line__value">abc@gmail.com</div>
              </div>
              <div class="button-wrap">
                <button
                  class="custom-button fit-button color-outline-black mr-3"
                >
                  비밀번호 재설정
                </button>
                <button class="custom-button fit-button color-black">
                  로그아웃
                </button>
              </div>
            </section>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
